<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>D3 Test</title>

	<!-- Major Libraries to have this work -->
	<script type = "text/javascript" src= "d3/d3.min.js"></script>
	<script type = "text/javascript" src= "d3/d3.js"></script>
	<script type = "text/javascript" src = "leaflet/leaflet-src.js"></script>
	<script type = "text/javascript" src = "jquery-2.1.4.js"></script>
	<script type = "text/javascript" src = "d3-timeline/src/d3-timeline.js"></script>
	<script type = "text/javascript" scr = "lodash.js"></script>
	<script type = "text/javascript" src = "colorbrewer.js"></script>
	<script type = "text/javascript" src = "leaflet.points-layers.js"></script>

	<!-- CSS Files -->
	<script type = "stylesheet" src = "timeline.css"></script>
	<script type = "stylesheet" src = "map.css"></script>

	<!-- Timeline Files -->
	<script type = "text/javascript">
	
  window.onload=function(){

    var data; // a global


    d3.json("dataProcessing/timeline3.json", function(error, json) {
      if (error) return console.warn(error);
      data = json;
      console.log('you got some data');

      var test = [
    {label: "timeline3", 
    times: [
        {
            "color": "green", 
            "ending_time": 1864, 
            "label": ":Emancipation Proclamation ends slavery in the South.", 
            "starting_time": 1863
        }, 
        {
            "color": "yellow", 
            "ending_time": 1866, 
            "label": "13th Amendment officially abolishes slavery.Juneteenth Freedom Celebration in Texas and Oklahoma.", 
            "starting_time": 1865
        }, 
        {
            "color": "green", 
            "ending_time": 1867, 
            "label": "Ex", 
            "starting_time": 1866
        }
        ]
      }
      ];
  var labelTestData = [
    {label: "person a", times: [{"starting_time": 1355752800000, "ending_time": 1355759900000}, {"starting_time": 1355767900000, "ending_time": 1355774400000}]},
    {label: "person b", times: [{"starting_time": 1355759910000, "ending_time": 1355761900000}, ]},
    {label: "person c", times: [{"starting_time": 1355761910000, "ending_time": 1355763910000}]},
    ];


      timelineHover(test);
    });

    var testData = [
    {times: [{"starting_time": 1355752800000, "ending_time": 1355759900000}, {"starting_time": 1355767900000, "ending_time": 1355774400000}]},
    {times: [{"starting_time": 1355759910000, "ending_time": 1355761900000}, ]},
    {times: [{"starting_time": 1355761910000, "ending_time": 1355763910000}]},
    ];

    var rectAndCircleTestData = [
    {times: [{"starting_time": 1355752800000,
    "display": "circle"}, {"starting_time": 1355767900000, "ending_time": 1355774400000}]},
    {times: [{"starting_time": 1355759910000,
    "display":"circle"}, ]},
    {times: [{"starting_time": 1355761910000, "ending_time": 1355763910000}]},
    ];

    var labelTestData = [
    {label: "person a", times: [{"starting_time": 1355752800000, "ending_time": 1355759900000}, {"starting_time": 1355767900000, "ending_time": 1355774400000}]},
    {label: "person b", times: [{"starting_time": 1355759910000, "ending_time": 1355761900000}, ]},
    {label: "person c", times: [{"starting_time": 1355761910000, "ending_time": 1355763910000}]},
    ];

    var iconTestData = [
    {class:"jackie", icon: "jackie.png", times: [
    {"starting_time": 1355752800000, "ending_time": 1355759900000}, 
    {"starting_time": 1355767900000, "ending_time": 1355774400000}]},
    {class:"troll", icon: "troll.png", times: [
    {"starting_time": 1355759910000, "ending_time": 1355761900000,
    "display":"circle"}, ]},
    {class:"wat", icon: "wat.png", times: [
    {"starting_time": 1355761910000, "ending_time": 1355763910000}]},
    ];

    var labelColorTestData = [
    {label: "person a", times: [{"color":"green", "label":"Weeee", "starting_time": 1355752800000, "ending_time": 1355759900000}, {"color":"blue", "label":"Weeee", "starting_time": 1355767900000, "ending_time": 1355774400000}]},
    {label: "person b", times: [{"color":"pink", "label":"Weeee", "starting_time": 1355759910000, "ending_time": 1355761900000}, ]},
    {label: "person c", times: [{"color":"yellow", "label":"Weeee", "starting_time": 1355761910000, "ending_time": 1355763910000}]},
    ];

    var testDataWithColor = [
    {label: "fruit 1", fruit: "orange", times: [
    {"starting_time": 1355759910000, "ending_time": 1355761900000}]},
    {label: "fruit 2", fruit: "apple", times: [
    {"starting_time": 1355752800000, "ending_time": 1355759900000},
    {"starting_time": 1355767900000, "ending_time": 1355774400000}]},
    {label: "fruit3", fruit: "lemon", times: [
    {"starting_time": 1355761910000, "ending_time": 1355763910000}]},
    ];

    var testDataWithColorPerTime = [
    {label: "fruit 2", fruit: "apple", times: [
    {fruit: "orange", "starting_time": 1355752800000, "ending_time": 1355759900000},
    {"starting_time": 1355767900000, "ending_time": 1355774400000},
    {fruit: "lemon", "starting_time": 1355774400000, "ending_time": 1355775500000}]}
    ];

    var testDataRelative = [
    {times: [{"starting_time": 1355752800000, "ending_time": 1355759900000}, {"starting_time": 1355767900000, "ending_time": 1355774400000}]},
    {times: [{"starting_time": 1355759910000, "ending_time": 1355761900000}]},
    {times: [{"starting_time": 1355761910000, "ending_time": 1355763910000}]},
    ];

    var width = 500;
    function timelineRect() {
      var chart = d3.timeline();

      var svg = d3.select("#timeline1").append("svg").attr("width", width)
      .datum(testData).call(chart);
    }


    function timelineHover(data) {
      console.log('got some data in some functions' , data);
     var chart = d3.timeline()
     .width(width*4)
     .stack()
     .margin({left:70, right:30, top:0, bottom:0})
     .hover(function (d, i, datum) {
	          // d is the current rendering object
	          // i is the index during d3 rendering
	          // datum is the id object
           var div = $('#hoverRes');
           var colors = chart.colors();
           div.find('.coloredDiv').css('background-color', colors(i))
           div.find('#name').text(datum.label);
         })
     .tickFormat({format: d3.time.format("%Y"), tickTime: d3.time.year,tickInterval: 6, tickSize: 6 })
     .click(function (d, i, datum) {
       alert(datum.label);
     })
     .scroll(function (x, scale) {
       $("#scrolled_date").text(scale.invert(x) + " to " + scale.invert(x+width));
     });

     var svg = d3.select("#timeline3").append("svg").attr("width", width)
     .datum(data).call(chart);
   }


   
 }
 </script>


</head>
<body>
	<p> This page loads! </p>


 <div id='map'></div>
    <script type="text/javascript">
    (function () {
        var extent, scale,
            classes = 9, scheme_id = "BuPu",
            reverse = false;
            scheme = colorbrewer[scheme_id][classes],
            container = L.DomUtil.get('map'),
            map = L.map(container).setView([42.877742,-97.380979], 5);

        L.tileLayer('http://{s}.tile.stamen.com/toner/{z}/{x}/{y}.png').addTo(map);

    
        }());
	</script>

	<div>
		<h3>A stacked timeline with hover, click, and scroll events</h3>
		<div id="timeline3"></div>
		<div id="hoverRes">
			<div class="coloredDiv"></div>
			<div id="name"></div>
			<div id="scrolled_date"></div>
		</div>
	</div>
</body>
</html>
